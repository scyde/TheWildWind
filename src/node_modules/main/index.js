import React, { Component } from 'react'
import { Switch, Route, withRouter } from 'react-router-dom'
import Loadable from 'react-loadable'
import Loading from 'loading'
import MainHeader from 'components/main_header'
import Header from 'containers/header'
import Footer from 'containers/footer'
import CatalogView from 'catalog_view'
import { connect } from 'react-redux'
import { bindActionCreators } from 'redux'
import { switchRoute } from 'actions/routeActions'

/* const Catalog = Loadable({
    loader: () => import('catalog'),
    loading: Loading
})
const About = Loadable({
    loader: () => import('about'),
    loading: Loading,
    delay: 500
})
const News = Loadable({
    loader: () => import('news'),
    loading: Loading,
    delay: 500
})
const Contacts = Loadable({
    loader: () => import('contacts'),
    loading: Loading,
    delay: 500
})
const Basket = Loadable({
    loader: () => import('basket'),
    loading: Loading,
    delay: 500
}) */
import News from 'news'
import Catalog from 'catalog'
import Contacts from 'contacts'
import Basket from 'basket'
import About from 'about'

class Main extends Component {
    constructor() {
        super()
        this.state = {}
    }
    static getDerivedStateFromProps(props, state) {
        props.switchRoute(location.pathname.slice(1))
        return state
    }
    render() {
        return (
            <div className="viewport">
                <CatalogView />
                <Header />
                <div className="main">
                    <MainHeader />
                    <Switch>
                        <Route path="/news" component={News} />
                        <Route path="/about" component={About} />
                        <Route path="/catalog" component={Catalog} />
                        <Route path="/contacts" component={Contacts} />
                        <Route path="/basket" component={Basket} />
                    </Switch>
                </div>
                <Footer />
            </div>
        )
    }
}
const mapDispatchToProps = dispatch => {
    return bindActionCreators(
        {
            switchRoute: switchRoute
        },
        dispatch
    )
}

export default connect(null, mapDispatchToProps)(withRouter(Main))
