import React, { Component } from 'react'
import { connect } from 'react-redux'
import BasketList from './list'
import CheckoutButtons from './checkout'
import BasketShipping from 'basket/shipping'

class Basket extends Component {
    constructor() {
        super()
        this.state = {
            page: 1
        }
    }
    switchPage = next => {
        const curPage = this.state.page
        if (next && curPage < 3)
            this.setState({
                page: curPage + 1
            })
        else if (!next && curPage > 1)
            this.setState({
                page: curPage - 1
            })
    }
    render() {
        const { page } = this.state
        const basketLength = this.props.basket.length
        return (
            <div className="basket">
                {basketLength > 0 ? (
                    [
                        page == 1 && <BasketList />,
                        page == 2 && <BasketShipping />,
                        <CheckoutButtons
                            page={page}
                            switchPage={this.switchPage}
                        />
                    ]
                ) : (
                    <p>'Ваша корзина пуста :('</p>
                )}
            </div>
        )
    }
}

const mapStateToProps = state => {
    return {
        basket: state.items.basket
    }
}

export default connect(mapStateToProps)(Basket)
